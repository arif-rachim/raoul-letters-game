'use strict';

var _templateObject = _taggedTemplateLiteral(['\n    <style>\n        body{\n            font-family: \'Lato\', sans-serif;\n            margin: 0px;\n            padding: 0px;\n        }\n        .raul-pic{\n            height: 70vh;\n            \n        }\n        .center{\n            text-align: center;\n        }\n        .start-button{\n            margin-top: 20px;\n            font-size: 2em;\n        }\n        \n        \n        \n        .btn {\n            border: none;\n            font-family: \'Lato\', sans-serif;\n            color: #ffffff;\n            font-size: 28px;\n            background: #3498db;\n            padding: 10px 20px 10px 20px;\n            text-decoration: none;\n        }\n        \n        \n    </style>\n    <div class="container">\n        <div class="center">\n            <img src="assets/raoul.jpg" class="raul-pic" alt="Responsive image">\n        </div>\n        <div class="center">\n            <button class="btn start-button animated bounceIn " onclick="', '">Start</button>\n        </div>\n    </div>\n    '], ['\n    <style>\n        body{\n            font-family: \'Lato\', sans-serif;\n            margin: 0px;\n            padding: 0px;\n        }\n        .raul-pic{\n            height: 70vh;\n            \n        }\n        .center{\n            text-align: center;\n        }\n        .start-button{\n            margin-top: 20px;\n            font-size: 2em;\n        }\n        \n        \n        \n        .btn {\n            border: none;\n            font-family: \'Lato\', sans-serif;\n            color: #ffffff;\n            font-size: 28px;\n            background: #3498db;\n            padding: 10px 20px 10px 20px;\n            text-decoration: none;\n        }\n        \n        \n    </style>\n    <div class="container">\n        <div class="center">\n            <img src="assets/raoul.jpg" class="raul-pic" alt="Responsive image">\n        </div>\n        <div class="center">\n            <button class="btn start-button animated bounceIn " onclick="', '">Start</button>\n        </div>\n    </div>\n    ']),
    _templateObject2 = _taggedTemplateLiteral(['\n    <style>\n        \n        body{\n            margin: 0px;\n            padding: 0px;\n        }\n        \n        h1{\n            font-weight: 100;\n            font-size: 4em;\n            color : #666;\n            bottom : 3px;\n            right : 10px;\n            margin : 0px;\n            position : absolute;\n            display: inline-block;\n        }\n        table{\n            text-align: center;\n        }\n        img {\n            width: calc( (100vw - 148px) / 2);\n            height: 25vh;\n        }\n        \n        .background-color {\n            background: #f2f6ff;\n            background: -moz-linear-gradient(top, #f2f6ff 2%, #f4f4eb 100%);\n            background: -webkit-linear-gradient(top, #f2f6ff 2%,#f4f4eb 100%);\n            background: linear-gradient(to bottom, #f2f6ff 2%,#f4f4eb 100%);\n            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#f2f6ff\', endColorstr=\'#f4f4eb\',GradientType=0 );\n        }\n        \n        .shadow {\n            -webkit-box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n            -moz-box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n            box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n        }\n        \n        .header{\n            text-align: right;\n            padding : 10px;\n            height : 60px;\n            position : relative;\n        }\n        \n        .hidden{\n            display: none;\n        }\n        \n        .button {\n            padding: 15px 25px;\n            text-align: center;\n            cursor: pointer;\n            outline: none;\n            color: #fff;\n            border: 1px solid #CCC;\n            border-radius: 15px;\n            box-shadow: 0 9px #CCC;\n        }\n        \n        .button:active {\n            box-shadow: 0 5px #BBB;\n            transform: translateY(4px);\n        }\n        \n        \n        \n    </style>\n    <div class="background-color header shadow" id="header" ></div>\n    </div>\n    <table>\n        <tr >\n            <td style="text-align:center">\n            <table style="margin-top: 20px;" cellspacing="10px" >\n                <tr>\n                    <td onclick="', '" >\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                    <td onclick="', '" >\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                        \n                    </td>\n                </tr>\n                <tr>\n                    <td onclick="', '">\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                    <td onclick="', '">\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n            </td>\n        </tr>\n    </table>\n    <button onclick="', '" style="border: none;font-family: \'Lato\';font-weight: 300;font-size:1em;color: white;background-color: red;position: absolute;bottom: 10px;left: 10px;">Reset</button>\n    \n'], ['\n    <style>\n        \n        body{\n            margin: 0px;\n            padding: 0px;\n        }\n        \n        h1{\n            font-weight: 100;\n            font-size: 4em;\n            color : #666;\n            bottom : 3px;\n            right : 10px;\n            margin : 0px;\n            position : absolute;\n            display: inline-block;\n        }\n        table{\n            text-align: center;\n        }\n        img {\n            width: calc( (100vw - 148px) / 2);\n            height: 25vh;\n        }\n        \n        .background-color {\n            background: #f2f6ff;\n            background: -moz-linear-gradient(top, #f2f6ff 2%, #f4f4eb 100%);\n            background: -webkit-linear-gradient(top, #f2f6ff 2%,#f4f4eb 100%);\n            background: linear-gradient(to bottom, #f2f6ff 2%,#f4f4eb 100%);\n            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#f2f6ff\', endColorstr=\'#f4f4eb\',GradientType=0 );\n        }\n        \n        .shadow {\n            -webkit-box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n            -moz-box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n            box-shadow: -1px 1px 35px -3px rgba(0,0,0,0.64);\n        }\n        \n        .header{\n            text-align: right;\n            padding : 10px;\n            height : 60px;\n            position : relative;\n        }\n        \n        .hidden{\n            display: none;\n        }\n        \n        .button {\n            padding: 15px 25px;\n            text-align: center;\n            cursor: pointer;\n            outline: none;\n            color: #fff;\n            border: 1px solid #CCC;\n            border-radius: 15px;\n            box-shadow: 0 9px #CCC;\n        }\n        \n        .button:active {\n            box-shadow: 0 5px #BBB;\n            transform: translateY(4px);\n        }\n        \n        \n        \n    </style>\n    <div class="background-color header shadow" id="header" ></div>\n    </div>\n    <table>\n        <tr >\n            <td style="text-align:center">\n            <table style="margin-top: 20px;" cellspacing="10px" >\n                <tr>\n                    <td onclick="', '" >\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                    <td onclick="', '" >\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                        \n                    </td>\n                </tr>\n                <tr>\n                    <td onclick="', '">\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                    <td onclick="', '">\n                        <div style="position: relative" class="button">\n                        <img src="assets/', '.jpg" >\n                        <label style="font-size: 4em;opacity: 0.1;position: absolute;bottom: 10px;right: 10px;color: #333">', '</label>\n                        </div>\n                    </td>\n                </tr>\n            </table>\n            </td>\n        </tr>\n    </table>\n    <button onclick="', '" style="border: none;font-family: \'Lato\';font-weight: 300;font-size:1em;color: white;background-color: red;position: absolute;bottom: 10px;left: 10px;">Reset</button>\n    \n']),
    _templateObject3 = _taggedTemplateLiteral(['<h1 class="">', '</h1>'], ['<h1 class="">', '</h1>']),
    _templateObject4 = _taggedTemplateLiteral(['<h1 class="animated bounceIn">', '</h1>'], ['<h1 class="animated bounceIn">', '</h1>']),
    _templateObject5 = _taggedTemplateLiteral(['<h1 >', '</h1>'], ['<h1 >', '</h1>']),
    _templateObject6 = _taggedTemplateLiteral(['<h1 style="margin: 0px;display: inline-block" class="animated bounceIn">', '</h1>'], ['<h1 style="margin: 0px;display: inline-block" class="animated bounceIn">', '</h1>']);

function _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Created by arif on 12/8/2017.
 */

var _ref = new Context(),
    html = _ref.html,
    htmlCollection = _ref.htmlCollection;

var render = yalla.render;
var repaintPage = function repaintPage() {
    render(html(_templateObject, function (e) {
        return startPlay();
    }), document.body);
};

var letters = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];
var letterAudios = letters.map(function (letter) {
    return new Audio('./assets/audio/' + letter + '.mp3');
});
var audioFromLetter = function audioFromLetter(letter) {
    return letterAudios[letters.indexOf(letter)];
};
var notRightAudio = new Audio('./assets/audio/notright.mp3');
var goodjob1Audio = new Audio('./assets/audio/good-job-1.mp3');
var goodjob2Audio = new Audio('./assets/audio/good-job-2.mp3');
var goodjob3Audio = new Audio('./assets/audio/good-job-3.mp3');
var goodjob4Audio = new Audio('./assets/audio/good-job-4.mp3');

var score = localStorage.getItem('score') || 0;
var strike = localStorage.getItem('strike') || 0;
score = parseInt(score);
strike = parseInt(strike);

var startPlay = function startPlay() {
    startChallange.play();
    startChallange.letter = generateLetter();
    var audio = audioFromLetter(startChallange.letter);
    debugger;
    audio.play();
    audio.pause();
};

var generateLetter = function generateLetter() {
    var letter = letters[Math.round(Math.random() * letters.length)];
    return letter ? letter : generateLetter();
};

var openNextPage = function openNextPage(nextLetter) {
    var questions = [nextLetter];
    while (questions.length < 4) {
        var falseLetter = generateLetter();
        if (questions.indexOf(falseLetter) < 0) {
            questions.push(falseLetter);
        }
    }
    shuffle(questions);
    audioFromLetter(nextLetter).play();
    render(html(_templateObject2, function (e) {
        return questions[0] == nextLetter ? correctAnswer() : wrongAnswer();
    }, questions[0], questions[0].toUpperCase(), function (e) {
        return questions[1] == nextLetter ? correctAnswer() : wrongAnswer();
    }, questions[1], questions[1].toUpperCase(), function (e) {
        return questions[2] == nextLetter ? correctAnswer() : wrongAnswer();
    }, questions[2], questions[2].toUpperCase(), function (e) {
        return questions[3] == nextLetter ? correctAnswer() : wrongAnswer();
    }, questions[3], questions[3].toUpperCase(), function (e) {
        return resetScore();
    }), document.body).then(function () {
        setTimeout(function () {
            return render(html(_templateObject3, score), document.getElementById('header'));
        }, 1000);
    });
};

var resetScore = function resetScore() {
    var x = window.confirm('Are you sure you want to reset the score ?');
    if (x) {
        score = 0;
        strike = 0;
        localStorage.setItem('score', score);
        localStorage.setItem('strike', strike);
        render(html(_templateObject4, score), document.getElementById('header'));
        setTimeout(function () {
            return render(html(_templateObject5, score), document.getElementById('header'));
        }, 1000);
    }
};

var shuffle = function shuffle(array) {
    var currentIndex = array.length,
        temporaryValue = void 0,
        randomIndex = void 0;
    while (0 !== currentIndex) {
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
    }
    return array;
};

var wrongAnswer = function wrongAnswer() {
    strike = 0;
    score = score - 1;
    if (score < 0) {
        score = 0;
    }
    localStorage.setItem('score', score);
    localStorage.setItem('strike', strike);
    notRightAudio.play();
    render(html(_templateObject4, score), document.getElementById('header'));
    setTimeout(function () {
        return render(html(_templateObject5, score), document.getElementById('header'));
    }, 1000);
};

var correctAnswer = function correctAnswer() {
    strike++;
    var multiply = 1;
    if (score < 20) {
        multiply = 2;
    } else if (score < 50) {
        multiply = 1;
    }
    score = score + multiply;
    localStorage.setItem('score', score);
    localStorage.setItem('strike', strike);
    var nextLetter = generateLetter();
    var nextAudio = audioFromLetter(nextLetter);
    try {
        nextAudio.play();
        nextAudio.pause();
    } catch (err) {
        console.log(err);
    }
    if (strike % 10 == 0) {
        goodjob4Audio.letter = nextLetter;
        goodjob4Audio.play();
    } else if (strike == 7) {
        goodjob3Audio.letter = nextLetter;
        goodjob3Audio.play();
    } else if (strike == 5) {
        goodjob2Audio.letter = nextLetter;
        goodjob2Audio.play();
    } else if (strike % 3 == 0) {
        goodjob1Audio.letter = nextLetter;
        goodjob1Audio.play();
    } else {
        openNextPageNow({ target: { letter: nextLetter } });
    }
};

var openNextPageNow = function openNextPageNow(e) {
    var letter = e.target.letter;
    render(html(_templateObject6, score), document.getElementById('header')).then(function () {
        return openNextPage(letter);
    });
};
// AUDIOS
var startChallange = new Audio('./assets/audio/challange-whichone.mp3');
startChallange.onended = function (e) {
    return openNextPage(e.target.letter);
};
goodjob1Audio.onended = openNextPageNow;
goodjob2Audio.onended = openNextPageNow;
goodjob3Audio.onended = openNextPageNow;
goodjob4Audio.onended = openNextPageNow;

repaintPage();